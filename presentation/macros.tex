\ifx\newelims\undefined
  \def\newelims{0}
\fi

\newcommand{\bind}[2]{\{#1\}#2}
\newcommand{\ctx}[2]{{#1}^{\rescomment{#2}}}
\newcommand{\ctxvar}[3]{#1 \stackrel{\rescomment{#3}}: #2}
\newcommand{\rescomment}[1]{{\color{red}#1}}


\newcommand{\ann}[2]{#1 : #2}
\newcommand{\emb}[1]{\underline{#1}}

\newcommand{\base}[0]{\iota}

\newcommand{\fun}[2]{#1 \multimap #2}
\newcommand{\lam}[2]{\lambda #1.~#2}
\newcommand{\app}[2]{#1~#2}

\newcommand{\excl}[2]{\oc_{#1} #2}
\newcommand{\bang}[1]{\operatorname{bang}~#1}
\newcommand{\bm}[4]{\if\newelims0%
\operatorname{bm}_{#1}(#2, \bind{#3}{#4})%
\else%
\operatorname{let}~\bang{#3} = #2~\operatorname{in}~#4 : #1%
\fi}

\newcommand{\tensorOne}[0]{1}
\newcommand{\unit}[0]{{*}_\otimes}
\newcommand{\del}[3]{\if\newelims0%
\operatorname{del}_{#1}(#2, #3)%
\else%
\operatorname{let}~\unit = #2~\operatorname{in}~#3 : #1%
\fi}

\newcommand{\tensor}[2]{#1 \otimes #2}
\newcommand{\ten}[2]{(#1, #2)_{\otimes}}
\newcommand{\prm}[5]{\if\newelims0%
\operatorname{pm}_{#1}(#2, \bind{#3, #4}{#5})%
\else%
\operatorname{let}~\ten{#3}{#4} = #2~\operatorname{in}~#5 : #1%
\fi}

\newcommand{\withTOne}[0]{\top}
\newcommand{\eat}[0]{{*}_{\with}}

\newcommand{\withT}[2]{#1 \with #2}
\newcommand{\wth}[2]{(#1, #2)_{\with}}
\newcommand{\proj}[2]{\operatorname{proj}_{#1}(#2)}

\newcommand{\sumTZero}[0]{0}
\newcommand{\exf}[2]{\operatorname{ex-falso}_{#1}(#2)}

\newcommand{\sumT}[2]{#1 \oplus #2}
\newcommand{\inj}[2]{\operatorname{inj}_{#1}(#2)}
\newcommand{\cse}[6]{\if\newelims0%
\operatorname{case}_{#1}(#2, \bind{#3}{#4}, \bind{#5}{#6})%
\else%
\operatorname{case}~#2~\operatorname{of}~\inj{0}{#3} \mapsto #4; \inj{1}{#5} \mapsto #6%
\fi}


\newcommand{\sem}[1]{\llbracket #1 \rrbracket}

%\def\tobar{\mathrel{\mkern3mu  \vcenter{\hbox{$\scriptscriptstyle+$}}%
%                    \mkern-12mu{\to}}}
\newcommand\tobar{\mathrel{\ooalign{\hfil$\mapstochar\mkern5mu$\hfil\cr$\to$\cr}}}

\pgfdeclarearrow{
  name = o,
  parameters = { \the\pgfarrowlength },
  setup code = {
    \pgfarrowssavethe\pgfarrowlength
  },
  drawing code = {
    \pgfpathmoveto{0.5\pgfarrowlength}{0em}
    \pgfpathcircle{0.5\pgfarrowlength}
  },
  defaults = { length = 0.5em }
}